# Инструкция по запуску проекта Lab_12

Этот проект содержит COM компонент и клиентские приложения для работы с ним.

## Структура проекта

- **SP02_COM** - COM DLL компонент (библиотека с интерфейсами IAdder и IMultiplier)
- **SP12_LIB** - Статическая библиотека-обертка над COM компонентом
- **SP12_02** - Клиентское приложение, использующее COM напрямую
- **SP12_04** - Клиентское приложение, использующее библиотеку SP12_LIB

## Порядок запуска

### Шаг 1: Сборка проекта

1. Откройте файл `Lab_12.sln` в Visual Studio
2. Выберите конфигурацию **Debug** и платформу **x64**
3. Соберите решение: **Build → Build Solution** (или Ctrl+Shift+B)

### Шаг 2: Регистрация COM компонента

**ВАЖНО:** Перед запуском клиентских приложений необходимо зарегистрировать COM DLL в системе.

Откройте PowerShell или Command Prompt **от имени администратора** и выполните:

```powershell
regsvr32.exe "C:\Users\nikit\OneDrive\Рабочий стол\СП\lab_3\x64\Debug\SP02_COM.dll"
```

Если регистрация прошла успешно, вы увидите сообщение:
```
DllRegisterServer в SP02_COM.dll выполнен успешно.
```

### Шаг 3: Запуск приложений

#### Запуск SP12_02 (прямое использование COM)

1. В Visual Studio установите проект **SP12_02** как проект запуска (правый клик → Set as StartUp Project)
2. Запустите проект (F5 или Ctrl+F5)

Или запустите напрямую:
```powershell
.\x64\Debug\SP12_02.exe
```

#### Запуск SP12_04 (использование через библиотеку)

1. В Visual Studio установите проект **SP12_04** как проект запуска
2. Запустите проект (F5 или Ctrl+F5)

Или запустите напрямую:
```powershell
.\x64\Debug\SP12_04.exe
```

## Отмена регистрации COM компонента

Если нужно удалить COM компонент из реестра:

```powershell
regsvr32.exe /u "C:\Users\nikit\OneDrive\Рабочий стол\СП\lab_3\x64\Debug\SP02_COM.dll"
```

## Возможные ошибки

### Ошибка: "CoCreateInstance error"
- **Причина:** COM DLL не зарегистрирован в системе
- **Решение:** Выполните регистрацию (Шаг 2)

### Ошибка: "Access is denied" при регистрации
- **Причина:** Недостаточно прав администратора
- **Решение:** Запустите PowerShell/CMD от имени администратора

### Ошибка компиляции: "Cannot open include file"
- **Причина:** Неправильные пути к заголовочным файлам
- **Решение:** Убедитесь, что все проекты находятся в одной папке и пути относительные

## Что делает проект

- **IAdder** - интерфейс для сложения (Add) и вычитания (Sub)
- **IMultiplier** - интерфейс для умножения (Mul) и деления (Div)

Оба приложения демонстрируют работу с COM компонентом, выполняя математические операции.


